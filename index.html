<html>
    <head>
        <title>YuppTube | Download YouTube Videos in HD</title>
        <link href="css/style.css" rel="stylesheet" type="text/css" media="all">
        <link rel="shortcut icon" href="images/favicon.ico">
        <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">
        <style>
            input {
                font-family: 'Roboto';
            }
        </style>
    </head>
  <body>
    <h1>â–º YuppTube</h1>
    <p>A new and (probably) unblocked YouTube downloader without ads!<br> Made by NormanTheIdiot<br> <b>NOTE</b>: This doesn't work for some YouTube videos, namely music videos and movies.</p>
    <p id="err" style="color:red;"></p>
    <input id="download" type="text" placeholder="Insert YouTube Link" maxlength="43" style="width: 300px;"><button onclick="start()">Grab Links</button>
    <div id=load style="display:none;"><p>Loading...</p><img src="images/loading.gif"</div>
    <p id="output"></p>
    <center id="player"></center>
    <script type="text/javascript">
      var d = document.getElementById("download");
      d.addEventListener("keydown", function (e) {
        if (e.keyCode == 13) {
          start()
        } 
      });
      function start() {
        document.getElementById("load").style.display = "block";
        if (document.getElementById("download").value.startsWith("https://youtube.com/watch?v=") === true) {download()}
        if (!document.getElementById("download").value.startsWith("https://youtube.com/watch?v=") === true) {serr()}
      }
      function download() {
        var input = document.getElementById("download").value;
        const Http = new XMLHttpRequest();
        const url='https://you-link.herokuapp.com/?url=' + input;
        Http.open("GET", url);
        Http.send();
        Http.onreadystatechange=(e)=>{
        var json = JSON.parse(Http.responseText)
        var url = json[0].url
        var quality = json[0].quality
        var type = json[0].type.substring(6,10)
        var type_ = type.replace(";", "")
        var rete = "<a href=" + url + " download='filename'>Download Video</a> | Quality: " + quality + " | Type: " + type_;
        var video = "<video controls autoplay width='720' height='360'><source src=" + url + " type=video/" + type_ +"></video>";
        document.getElementById("load").style.display = 'none';
        document.getElementById("output").innerHTML = rete;
        document.getElementById("player").innerHTML = video;
      }
     }
     function serr() {
        document.getElementById("err").innerHTML = "This link is not valid.<br> Make sure the link is <b>exactly</b> like this<br><code>https://youtube.com/watch?v=XXXXXX</code>"   
     }
    </script>
</body></html>
